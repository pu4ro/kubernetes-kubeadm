---
# Basic Kubernetes Cluster Configuration

# Kubernetes Settings
kubernetes_version: '1.27.14'
dns_domain: cluster.local
service_subnet: 10.96.0.0/12
pod_subnet: 10.244.0.0/16

# High Availability Settings (for multi-master setup)
master_ha: true
kube_vip_port: 6443
kube_vip_interface: eth0
kube_vip_address: 192.168.135.29  # Uncomment for HA setup

# Container Runtime
containerd_version: "1.7.6"

# System Configuration
set_timezone: Asia/Seoul

# NTP/Chrony Configuration
use_local_ntp: true                    # true: master1 as NTP server, false: use external NTP
external_ntp_servers: {}             # External NTP servers
  #  - "pool.ntp.org"
  #  - "time.google.com"
  #  - "time.cloudflare.com"
cluster_network: "192.168.0.0/16"     # Network range allowed to access local NTP server

# Cross-platform service and config paths
chrony_service_name: "{{ 'chronyd' if ansible_os_family == 'RedHat' else 'chrony' }}"
chrony_config_path: "{{ '/etc/chrony.conf' if ansible_os_family == 'RedHat' else '/etc/chrony/chrony.conf' }}"

# Network Plugin (flannel is default)
network_plugin: "flannel"

# Master Node Scheduling (allow pods on master for single-node setup)
allow_master_scheduling: true

# Certificate Extension (extend certificates to 10 years)
extend_k8s_certificates: true

# Parallel Execution Control
# Set how many hosts to run simultaneously during installation
# 1 = sequential (one at a time), 0 = all hosts in parallel
parallel_execution:
  system_preparation: 0     # How many hosts for system prep phase (packages, containerd)
  package_installation: 0   # How many hosts for apt/yum operations simultaneously
  kubernetes_installation: 0  # How many hosts for kubernetes installation (0 = all parallel)

# Example configurations:
# For fast installation on reliable network (all parallel):
# parallel_execution:
#   system_preparation: 0
#   package_installation: 0  
#   kubernetes_installation: 0
#
# For mixed approach (packages sequential, k8s parallel):
# parallel_execution:
#   system_preparation: 1
#   package_installation: 1
#   kubernetes_installation: 0
#
# For completely sequential installation:
# parallel_execution:
#   system_preparation: 1
#   package_installation: 1
#   kubernetes_installation: 1

# Package Repository URLs (for offline installation)
repo_url:
  centos: "http://192.168.1.10:8080/repo/"
  ubuntu: "http://192.168.134.102/ubuntu_24.04.3"

# Container Registry Settings (basic Docker configuration)
insecure_registries: 
  #- "192.168.1.10:5000"           # Local registry example
  # - "harbor.yourdomain.com"     # Harbor registry example
  # - "registry.local"            # Custom registry example
docker_log_max_size: "100m"

# Kubernetes pause container image
pause_image: "cr.makina.rocks/external-hub/kubernetes/pause:3.9"

# NVIDIA runtime support for containerd
nvidia_runtime: false

