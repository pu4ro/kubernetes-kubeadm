# Chrony NTP Server Configuration (Master1)
# This node acts as the local NTP server for the cluster

# External time sources for the NTP server
{% for server in external_ntp_servers %}
server {{ server }} iburst
{% endfor %}

# Allow clients from the cluster network
allow {{ cluster_network | default('192.168.0.0/16') }}

# Serve time even if not synchronized to external sources
local stratum 8

# Location of drift and log files
driftfile /var/lib/chrony/drift
logdir /var/log/chrony

# Select which information is logged
log measurements statistics tracking

# Stop bad estimates upsetting machine clock
maxupdateskew 100.0

# Enable kernel synchronization of the real-time clock (RTC)
rtcsync

# Step the system clock instead of slewing it if the adjustment is larger than
# one second, but only in the first three clock updates
makestep 1 3

# Enable hardware timestamping on all interfaces that support it
#hwtimestamp *

# Increase the minimum number of selectable sources required to adjust
# the system clock
#minsources 2

# Allow for large clock adjustments
maxchange 1000 1 2