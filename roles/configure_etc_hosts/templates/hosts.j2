127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4
::1         localhost localhost.localdomain localhost6 localhost6.localdomain6

# Ansible managed hosts
{% for host in groups['all'] %}
{% if enable_domain_communication | default(false) %}
{{ hostvars[host]['ansible_host'] | default(hostvars[host]['inventory_hostname']) }} {{ hostvars[host]['inventory_hostname'] }} {{ hostvars[host]['inventory_hostname'] }}.{{ domain_suffix }}
{% else %}
{{ hostvars[host]['ansible_host'] | default(hostvars[host]['inventory_hostname']) }} {{ hostvars[host]['inventory_hostname'] }}
{% endif %}
{% endfor %}

{% if enable_domain_communication | default(false) %}
# Kubernetes API domain
{% if kube_vip_address is defined %}
# Points to VIP for HA with kube-vip
{{ kube_vip_address }} {{ api_domain | default('k8s-api.local') }}
{% else %}
# Points to first master (for single master or external LB configuration)
# NOTE: For external LB, override this in custom_hosts with LB IP
{{ hostvars[groups['masters'][0]]['ansible_host'] | default(hostvars[groups['masters'][0]]['inventory_hostname']) }} {{ api_domain | default('k8s-api.local') }}
{% endif %}
{% endif %}

{% if registry_hosts is defined and registry_hosts | length > 0 %}
# Registry hosts
{% for hostname, ip in registry_hosts.items() %}
{{ ip }} {{ hostname }}
{% endfor %}
{% endif %}

{% if custom_hosts is defined and custom_hosts | length > 0 %}
# Custom hosts
{% for hostname, ip in custom_hosts.items() %}
{{ ip }} {{ hostname }}
{% endfor %}
{% endif %}
